---
title: "An analysis of English Premier League Data from 1992-2022"
output: word_document
date: "2024-10-24"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
if(!require("ggplot2")){install.packages("ggplot2")}
if(!require("flextable")){install.packages("flextable")}
if(!require("psych")){install.packages("psych")}
if(!require("tableone")){install.packages("tableone")}

library(ggplot2)
library(flextable)
library(psych)
library(tableone)
```

# An Introduction to the Data

Dataset is thanks to Evan Gower on Kaggle, and can be found at: https://www.kaggle.com/datasets/evangower/premier-league-matches-19922022

Each entry represents an English Premier League match with the following information:

+ **Season_End_Year** - The Year that the Season ends in.
+ **Wk** - The Game Week.
+ **Date** - Date the Game took place on.
+ **Home** - The Home Team.
+ **HomeGoals** - Amount of Goals scored by the Home Team.
+ **AwayGoals** - Amount of Goals scored by the Away Team.
+ **Away** - The Away Team.
+ **FTR** - Full Time Result. (H - Home Win, D - Draw, A - Away Win)

```{r echo=FALSE}
results <- read.csv("data/premier-league-matches.csv")
head(results)
```
# brief Dataset Exploration
```{r}
str(results)
summary(results)
summary(results$HomeGoals)
names(results)
```
# Some Charts
```{r}
ggplot(data=results)+
  geom_histogram(mapping=aes(x=HomeGoals))

ggplot(data=results,aes(x=HomeGoals, y=AwayGoals))+
  geom_boxplot()
  
ggplot(data=results,aes(x=Wk,y=HomeGoals))+
  geom_point()
```

```{r}
Filtered_results = subset (results, (Home == "Arsenal" | Away == "Arsenal") & Season_End_Year == "2020")
Filtered_results
wdl_table <- table(Filtered_results$FTR)
num_filtered_games <- nrow(Filtered_results)


```
# How many unique teams have played in the Premier League?
A brief exploration shows that 50 unique teams have played in the Premier League.
```{r echo=FALSE}
all_epl_sides <- sort(unique(c(results$Home, results$Away)))
length(all_epl_sides)
all_epl_sides
```

